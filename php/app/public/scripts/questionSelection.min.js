var questionSelection={selectionTable:null,translate:null,exportUrl:null,questionSelectionUrl:null,maxQuestionDisplay:null,basketRemoveImgSrc:"/img/icons/basket_remove.png",xlsExportImgSrc:"/img/icons/xls_hover.png",csvExportImgSrc:"/img/icons/csv_hover.png",init:function(a){this.translate=a.translate;this.exportUrl=a.exportUrl;this.questionSelectionUrl=a.questionSelectionUrl;this.maxQuestionDisplay=a.maxQuestionDisplay;this._initTable();this._initExportAndClearBasketDiv();this._addBasketDeleteListener();this._addTogglerListener();return this},_initTable:function(){this.selectionTable=$("table.selection").dataTable({sDom:'l<"export">rtip',aLengthMenu:[5,10,25],iDisplayLength:this.maxQuestionDisplay,aoColumns:[null,null,null,{bSortable:false,bSearchable:false},{bSortable:false,bSearchable:false}],oLanguage:{sLengthMenu:this.translate.table.lengthMenu,sZeroRecords:this.translate.table.zeroRecord,sInfo:this.translate.table.info,sInfoEmpty:this.translate.table.infoEmpty,sInfoFiltered:this.translate.table.infoFiltered,sSearch:this.translate.table.search,oPaginate:{sPrevious:this.translate.table.paginate.previous,sNext:this.translate.table.paginate.next}},fnInitComplete:function(a){if(a.fnRecordsDisplay()<=this.maxQuestionDisplay){$(".dataTables_length").hide();$(".dataTables_filter").hide();$(".dataTables_paginate").hide();$(".dataTables_info").hide()}},sPaginationType:"input",fnRowCallback:function(d,c,b,a){$(d).css("display","");return d}})},_initExportAndClearBasketDiv:function(){$("div.export").html('<img src="'+this.basketRemoveImgSrc+'" id="clearCart" title="'+this.translate.clearBasket+'"/><img src="'+this.csvExportImgSrc+'" id="exportCsv" title="'+this.translate.exportCsv+'"/><img src="'+this.xlsExportImgSrc+'" id="exportXls" title="'+this.translate.exportXls+'"/>');$("#exportCsv").click(function(){var a=questionSelection.exportUrl;a+="?&format=csv";$(location).attr("href",a)});$("#exportXls").click(function(){var a=questionSelection.exportUrl;a+="?&format=xlsx";$(location).attr("href",a)});$("#clearCart").click(function(){if(confirm(questionSelection.translate.clearBasketConfirm)){basket.clear();$(location).attr("href",questionSelection.questionSelectionUrl)}})},_addBasketDeleteListener:function(){$("td.delete img").live("click",function(){var b=$(this).closest("tr");basket.remove(b.attr("id").split("_")[1]);questionSelection.selectionTable.fnDeleteRow(b.get(0));var a=$("#topMenu span.count");var d=parseInt(a.text(),10)-1;a.text(d);if(d===0&&$("#topMenu a.questionSelection").hasClass("notEmpty")){$("#topMenu a.questionSelection").removeClass("notEmpty")}})},_addTogglerListener:function(){$("ul.more").live("click",function(){if($(this).hasClass("toggled")){$(this).removeClass("toggled")}else{$(this).addClass("toggled")}BDQGrips.resizeGrips()});$("td.question a").click(function(a){a.stopPropagation()})}};